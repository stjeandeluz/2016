---
title: "Homework 1: Insights on Poverty"
date: "February 4, 2016"
output: html_document
---
 
**This homework is due Sunday February 14, 2016 at 11:59 PM. When complete, submit your code in the R Markdown file and the knitted HTML file on Canvas.**


# Background

This HW is based on Hans Rosling talks [New Insights on Poverty](https://www.ted.com/talks/hans_rosling_reveals_new_insights_on_poverty?language=en) and [The Best Stats You've Ever Seen](https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen). 

The assignment uses data to answer specific question about global health and economics. The data contradicts commonly held preconceived notions. For example, Hans Rosling starts his talk by asking: (paraphrased) "for each of the six pairs of countries below, which country do you think had the highest child mortality in 2015?" 

1. Sri Lanka or Turkey
2. Poland or South Korea
3. Malaysia or Russia
4. Pakistan or Vietnam
5. Thailand or South Africa

Most people get them wrong. Why is this? In part it is due to our preconceived notion that the world is divided into two groups: the
_Western world_ versus the _third world_, characterized by "long life,small family" and "short life, large family" respectively. In this homework we will use data visualization to gain insights on this topic.  


# Problem 1

The first step in our analysis is to download and organize the data. The necessary data to answer these question is available on the [gapminder](http://www.gapminder.org/data/) website. 

## Problem 1.1

We will use the following datasets:

1.     [Childhood mortality](http://spreadsheets.google.com/pub?key=0ArfEDsV3bBwCcGhBd2NOQVZ1eWowNVpSNjl1c3lRSWc&output=csv)
2.     [Life expectancy](http://spreadsheets.google.com/pub?key=phAwcNAVuyj2tPLxKvvnNPA&output=csv)
3.     [Fertility](http://spreadsheets.google.com/pub?key=phAwcNAVuyj0TAlJeCEzcGQ&output=csv)
4.     [Population](http://spreadsheets.google.com/pub?key=phAwcNAVuyj0XOoBL_n5tAQ&output=csv)
5.     [Total GDP](http://spreadsheets.google.com/pub?key=pyj6tScZqmEfI4sLVvEQtHw&output=csv)

Create five `tbl_df` table objects, one for each of the tables provided in the above files. Hints: Use the `read_csv` function. Because these are only temporary files, give them short names.
```{r,include=FALSE}
# Put your code here.\
> temp_mortal <- read.csv("C:/R files/indicator gapminder under5mortality - Data.csv")
> temp_life <- read.csv("C:/R files/indicator life_expectancy_at_birth - Data.csv")
> temp_fertile <- read.csv("C:/R files/indicator undata total_fertility - Data.csv")
> temp_pop <- read.csv("C:/R files/indicator gapminder population - Data.csv")
> temp_gdp <- read.csv("C:/R files/indicator GDP at market prices, constant 2000 US$ (WB estimates) - Data.csv")

```


## Problem 1.2

 Write a function called `my_func` that takes a table as an argument and returns the column name. For each of the five tables, what is the name of the column containing the country names? Print out the tables or look at them with `View` to determine the column.

```{r}
# Your code goes here.
> my_func <- function(table_name) {colnames(table_name)}
> my_func(temp_mortal)
> my_func(temp_life)
> my_func(temp_fertile)
> my_func(temp_pop)
> my_func(temp_gdp)

> # in each table country name is in column 1
> # in temp_mortal: Under.five.mortality
> View(temp_life)
> # in temp_life: Life.expectancy.with.projections..Yellow.is.IHME
> View(temp_fertile)
> # in temp_fertile: Total.fertility.rate
> # in temp_pop: Total.population
> View(temp_gdp)
> # in temp_gdp: GDP..constant.2000.US..


```

## Problem 1.3 

In the previous problem we noted that gapminder is inconsistent in naming their country column. Fix this by assigning a common name to this column in the various tables.

```{r}
# Your code goes here.
> names(temp_mortal)[1]<-"country"
> names(temp_life)[1]<-"country"
> names(temp_fertile)[1]<-"country"
> names(temp_pop)[1] <- "country"
> names(temp_gdp)[1] <- "country

```

## Problem 1.4 

Notice that in these tables, years are represented by columns. We want to create a tidy dataset in which each row is a unit or observation and our 5 values of interest, including the year for that unit, are in the columns. The unit here is a country/year pair and each unit gets values:

```{r}
# Your code goes here.
# see below ...

```

We call this the _long_ format. Use the `gather` function from the `tidyr` package to create a new table for childhood mortality using the long format. Call the new columns `year` and `child_mortality`

```{r}
# Your code goes here.
> install.packages("tidyr")
> library(tidyr)

> # use column counts from my_func
> mortal <- gather(temp_mortal,year,child_mortality,X1800:X2015)

```

Now redefine the remaining tables in this way.

```{r}
# Your code goes here.
> life <- gather(temp_life,year,life_expectancy,X1800:X2015)
> fertile <- gather(temp_fertile,year,fertility,X1800:X2015)
> pop <- gather(temp_pop,year,population,X1800:X2015)
> gdp <- gather(temp_gdp,year,gdp,X1960:X2011)
```


## Problem 1.5

Now we want to join all these files together. Make one consolidated table containing all the columns

```{r}
# Your code goes here.
> all_1 <- merge(mortal,life,all=TRUE)
> all_2 <- merge(all_1,fertile,all=TRUE)
> all_3 <- merge(all_2,pop,all=TRUE)
> alldata <- merge(all_3,gdp,all=TRUE)

```

## Problem 1.6

Add a column to the consolidated table containing the continent for each country. Hint: We have created a file that maps countries to continents [here](https://github.com/datasciencelabs/data/blob/master/homework_data/continent-info.tsv). Hint: Learn to use the `left_join` function.

```{r}
# Your code goes here.
> # left join for continent (used this option instead)
> alldata_2 <- merge(alldata,continents,by.x="country",by.y="country",all.x=TRUE)
> View(alldata_2)

```

# Problem 2 

Report the child mortalilty rate in 2015 for these 5 pairs:

1. Sri Lanka or Turkey
2. Poland or South Korea
3. Malaysia or Russia
4. Pakistan or Vietnam
5. Thailand or South Africa

```{r}
# Your code goes here.
> all_mortal <- alldata_2[c(1:3)]

> mortal_Sri_Lanka <- all_mortal[ which(all_mortal$country %in% ('Sri Lanka') & all_mortal$year=='X2015'),]
> mortal_Turkey <- all_mortal[ which(all_mortal$country %in% ('Turkey') & all_mortal$year=='X2015'),]
> mortal_Poland <- all_mortal[ which(all_mortal$country %in% ('Poland') & all_mortal$year=='X2015'),]
>  mortal_South_Korea <- all_mortal[ which(all_mortal$country %in% ('South Korea') & all_mortal$year=='X2015'),]
> mortal_Malaysia <- all_mortal[ which(all_mortal$country %in% ('Malaysia') & all_mortal$year=='X2015'),]
> mortal_Russia <- all_mortal[ which(all_mortal$country %in% ('Russia') & all_mortal$year=='X2015'),]
> mortal_Pakistan <- all_mortal[ which(all_mortal$country %in% ('Pakistan') & all_mortal$year=='X2015'),]
> mortal_Vietnam <- all_mortal[ which(all_mortal$country %in% ('Vietnam') & all_mortal$year=='X2015'),]
> mortal_Thailand <- all_mortal[ which(all_mortal$country %in% ('Thailand') & all_mortal$year=='X2015'),]
> mortal_South_Africa <- all_mortal[ which(all_mortal$country %in% ('South Africa') & all_mortal$year=='X2015'),]

> Sri_Turkey <- rbind(mortal_Sri_Lanka,mortal_Turkey)
> View(Sri_Turkey)
> # Sri Lanka has lower rate: 8.7 v 13.5
> Poland_Korea <- rbind(mortal_Poland,mortal_South_Korea)
> View(Poland_Korea)
> # South Korea has lower rate: 3.5 v 5.2
> Malaysia_Russia <- rbind(mortal_Malaysia,mortal_Russia)
> View(Malaysia_Russia)
> # Malaysia has lower rate: 8.2 v 9.6
> Pakistan_Vietnam <- rbind(mortal_Pakistan,mortal_Vietnam)
> View(Pakistan_Vietnam)
> # Vietnam has lower rate: 21.7 v 81.1
> Thailand_South_Africa <- rbind(mortal_Thailand,mortal_South_Africa)
> View(Thailand_South_Africa)
> # Thailand has lower rate: 12.3 v 42.1

```

# Problem 3

To examine if in fact there was a long-life-in-a-small-family and short-life-in-a-large-family dichotomy,  we will visualize the average number of children per family (fertility) and the life expectancy for each country.

## Problem 3.1 

Use `ggplot2` to create a plot of life expectancy versus fertiltiy for 1962 for Africa, Asia, Europe, and the Americas. Use color to denote continent and point size to denote population size:

```{r}
# Your code goes here.
> install.packages("ggplot2")
> library(ggplot2)

> alldata_1962 <- alldata_2[ which(alldata_2$year=='X1962'),]

> # dropping observations with missing fertility/expectancy information
> lifespan_fertility_2 <- alldata_1962[ which(alldata_1962$fertility> 0),]
> lifespan_fertility_3 <- lifespan_fertility_2[ which(lifespan_fertility_2$life_expectancy> 0),]
> # Oceania not required
> lifespan_fertility_4 <- lifespan_fertility_3[ which(lifespan_fertility_3$continent != 'Oceania'),]

> # convert population to numeric variable and use log to scale the relative sizes
> lifespan_fertility_4$population2 <- as.numeric(lifespan_fertility_4$population)
> ggplot(lifespan_fertility_4, aes(x=fertility,y=life_expectancy,color=continent)) + geom_point(aes(size=log(population2)))

> # general relationship: lower fertility associated with higher life expectancy
> # For 1962 data, Europe clustered around high life expectancy/low fertility
> # Africa at other end of the spectrum: lower life expectancy/higher fertility
> # countries in Asia/Americas more spread out along the relationship trendline
> # Americas more evenly spaced, Asia perhaps more similar to Africa than Europe



```

Do you see a dichotomy? Explain.

## Problem 3.2

Now we will annotate the plot to show different types of countries. 

Learn about OECD and OPEC. Add a couple of columns to your consolidated tables containing a logical vector that tells if a country is OECD and OPEC respectively. It is ok to base membership on 2015.

```{r}
# Your code goes here.
> # make Excel list of OECD and OPEC indicators and load
> OECD_OPEC <- read.csv("C:/R files/OECD_OPEC.csv")
> View(OECD_OPEC)
> # file has the OPEC and OECD countries + variables 'OPEC' and 'OECD' set equal to 1 if the country is a member of that organization


> alldata_3 <- merge(alldata_2,OECD_OPEC,by.x="country",by.y="country",all.x=TRUE)


```

### Problem 3.3

Make the same plot as in Problem 3.1, but this time use color to annotate the OECD countries and OPEC countries. For countries that are not part of these two organization annotate if they are from Africa, Asia, or the Americas.

```{r}
# Your code goes here.
> alldata_1962 <- alldata_3[ which(alldata_3$year=='X1962'),]

> # dropping observations with missing fertility/expectancy information
> lifespan_fertility_2 <- alldata_1962[ which(alldata_1962$fertility> 0),]
> lifespan_fertility_3 <- lifespan_fertility_2[ which(lifespan_fertility_2$life_expectancy> 0),]
> # Oceania not required
> lifespan_fertility_4 <- lifespan_fertility_3[ which(lifespan_fertility_3$continent != 'Oceania'),]

> # split data into 3, create new category variable, re-stack
> lifespan_fertility_4$newvar <- pmax(lifespan_fertility_4$OECD,lifespan_fertility_4$OPEC,na.rm=TRUE)
> # convert NAs to zeroes
> lifespan_fertility_4[is.na(lifespan_fertility_4)] <- 0
> OPEC <- lifespan_fertility_4[ which(lifespan_fertility_4$OPEC=='1'),]
> OECD <- lifespan_fertility_4[ which(lifespan_fertility_4$OECD=='1'),]
> OTHERS <- lifespan_fertility_4[ which(lifespan_fertility_4$newvar=='0'),]
> OPEC$category <- "OPEC"
> OECD$category <- "OECD"
> OTHERS$category <- OTHERS$continent
> re_stack=rbind(OPEC,OECD,OTHERS)


> # convert population to numeric variable and use log to scale the relative sizes
> re_stack$population2 <- as.numeric(re_stack$population)
> re_stack<- re_stack[ which(re_stack$category != 'Europe'),]
> ggplot(re_stack, aes(x=fertility,y=life_expectancy,color=category)) + geom_point(aes(size=log(population2)))

> # The main dichotomy here in 1962 is between OECD and the other categories,
> # especially Africa. The former has sharply higher life expectancy and
> # lower fertility.



```

How would you describe the dichotomy?


### Problem 3.4

Explore how this figure changes across time. Show us 4 figures that demonstrate how this figure changes through time.

```{r}
# Your code goes here.
> # data in 3.3 shows information in 1962
> # will select 1975, 1990, 2000, 2015 as other years to observe
> # below is code for 1975, repeats with the other 3 years; not re-copied here

> alldata_1975 <- alldata_3[ which(alldata_3$year=='X1975'),]

> # dropping observations with missing fertility/expectancy information
> lifespan_fertility_2 <- alldata_1975[ which(alldata_1975$fertility> 0),]
> lifespan_fertility_3 <- lifespan_fertility_2[ which(lifespan_fertility_2$life_expectancy> 0),]
> # Oceania not required
> lifespan_fertility_1975 <- lifespan_fertility_3[ which(lifespan_fertility_3$continent != 'Oceania'),]

> # split data into 3, create new category variable, re-stack
> lifespan_fertility_1975$newvar <- pmax(lifespan_fertility_1975$OECD,lifespan_fertility_1975$OPEC,na.rm=TRUE)
> # convert NAs to zeroes
> lifespan_fertility_1975[is.na(lifespan_fertility_1975)] <- 0
> OPEC <- lifespan_fertility_1975[ which(lifespan_fertility_1975$OPEC=='1'),]
> OECD <- lifespan_fertility_1975[ which(lifespan_fertility_1975$OECD=='1'),]
> OTHERS <- lifespan_fertility_1975[ which(lifespan_fertility_1975$newvar=='0'),]
> OPEC$category <- "OPEC"
> OECD$category <- "OECD"
> OTHERS$category <- OTHERS$continent
> re_stack_1975=rbind(OPEC,OECD,OTHERS)
> re_stack_1975 <- re_stack_1975[ which(re_stack_1975$category != 'Europe'),]


> # convert population to numeric variable and use log to scale the relative sizes
> re_stack_1975$population2 <- as.numeric(re_stack_1975$population)
> ggplot(re_stack_1975, aes(x=fertility,y=life_expectancy,color=category)) + geom_point(aes(size=log(population2)))

> # [graphs pasted here in HW1 doc]

> # looking at the 4 years chosen
> # the dichotomy between Africa and OECD is still present
> # and appears more stark because of the greater relative progress by 
> # Asia/America/OPEC countries toward the lower fertility/higher life expectancy   
    zone.
> # all groups seem to have moved in that general direction, but the improvement 
> # in Africa seems not as much, so the original gap in 1962 has not completely closed.



```

Would you say that the same dichotomy exists today? Explain:

## Problem 3.5 (Optional)

Make an animation with the `gganimate` package.

```{r, eval=FALSE}
# Your code goes here.
# out of time, but will try it later!
```


# Problem 4 
Having time as a third dimension made it somewhat difficult to see specific country trends. Let's now focus on specific countries.

## Problem 4.1
Let's compare France and its former colony Tunisia. Make a plot of fertility versus year with color denoting the country. Do the same for life expecancy. How would you compare Tunisia's improvement compared to France's in the past 60 years? Hint: use `geom_line`
 
```{r}
# Put your code here.

> # select fertility data for France and Tunisia - all years; use gathered data
> fertile_France_Tunisia <- fertile[ which(fertile$country %in% ('France') | fertile$country %in%  ('Tunisia')),]
> # make plot
> ggplot(data=fertile_France_Tunisia,aes(x=year,y=fertility,group=country,colour=country)) + geom_line() + scale_x_discrete(breaks = pretty_breaks(n=10))



> # select life expectancy data for France and Tunisia - all years; use gathered data
> life_France_Tunisia <- life[ which(life$country %in% ('France') | life$country %in%  ('Tunisia')),]
> # make plot
> ggplot(data=life_France_Tunisia,aes(x=year,y=life_expectancy,group=country,colour=country)) + geom_line() + scale_x_discrete(breaks = pretty_breaks(n=10))


> # Looking at the graphs, can see that fertility in Tunisia has decreased
> # almost to the level of France in last 60 years. Lifespan in Tunisia has been increasing at a 
> # faster rate than France until recently, but lately it appears to have
> # settled at a similar rate of increase, and a life expectancy gap persists.
> # Interesting to see correlated dips in life expectancy at certain recent
> # periods. May be related to colonial conflicts at that time.


```

## Problem 4.2

Do the same, but this time compare Vietnam to the OECD countries.

```{r}
# Put your code here.

> # merge OECD file with fertility data
> fertile_2 <- merge(fertile,OECD_OPEC,by.x="country",by.y="country",all.x=TRUE)

> # OECD countries data - compute average fertility
> fertile_OECD <- fertile_2[ which( fertile_2$OECD == '1'),]
> OECD_avg <- aggregate( fertility~year,fertile_OECD, mean  )
> OECD_avg$name <- 'OECD'

> # similar datastet but for Vietnam (Vietnam not OECD)
> fertile_Vietnam <- fertile_2[ which( fertile_2$country %in% ('Vietnam')),]
> Vietnam_avg <- aggregate( fertility~year,fertile_Vietnam, mean  )
> Vietnam_avg$name <- 'Vietnam'

> # create 1 time-series dataset via rbind
> V_OECD_fertility <- rbind(OECD_avg,Vietnam_avg)

> # make a plot
> ggplot(data=V_OECD_fertility,aes(x=year,y=fertility,group=name,colour=name)) + geom_line() +  scale_x_discrete(breaks = pretty_breaks(n=10))

> # While the OECD countries' fertility has generally declined over the period 
> # in question, Vietnamese fertility had a mid-20th century "boom" that fell
> # off sharply in the 1970s and 80s. Today, fertility levels are very similar
> # between Vietnam and the OECD countries.

Do similar with life expectancy…

> # merge OECD file with life expectancy data
> life_2 <- merge(life,OECD_OPEC,by.x="country",by.y="country",all.x=TRUE)

> # OECD countries data - compute average life expectancy
> life_OECD <- life_2[ which( life_2$OECD == '1'),]
> OECD_avg <- aggregate( life_expectancy~year,life_OECD, mean  )
> OECD_avg$name <- 'OECD'

> # similar datastet but for Vietnam (Vietnam not OECD)
> life_Vietnam <- life_2[ which( life_2$country %in% ('Vietnam')),]
> Vietnam_avg <- aggregate( life_expectancy~year,life_Vietnam, mean  )
> Vietnam_avg$name <- 'Vietnam'

> # create 1 time-series dataset via rbind
> V_OECD_life<- rbind(OECD_avg,Vietnam_avg)

> # make a plot
> ggplot(data=V_OECD_life,aes(x=year,y=life_expectancy,group=name,colour=name)) + geom_line() +  scale_x_discrete(breaks = pretty_breaks(n=10))


> # Life expectancy has generally increased over time in both the OECD zone
> # and in Vietnam. There are several sharp downward spikes in both regions
> # however. 2 of the spikes are correlated, and it is possible they are due
> # to the World Wars in which both OECD countries and Vietnam felt the 
> # effects. One spike appears to impact Vietnam alone; could be due to the 
> # Vietnam War conflict which did not draw in most OECD countries. OECD
> # life expectancy is higher than for Vietnam, and the gap does not appear
> # to be closing as of late.


```


# Problem 5

We are now going to examine GDP per capita per day.

## Problem 5.1

Create a smooth density estimate of the distribution of GDP per capita per day across countries in 1970. Include OECD, OPEC, Asia, Africa, and the Americas in the computation. When doing this we want to weigh countries with larger populations more. We can do this using the "weight"" argument in `geom_density`. 

```{r,warning=FALSE}
# Your code goes here.

> # select 1970 data from the aggregate dataset 
> alldata_1970 <- alldata_3[ which(alldata_3$year=='X1970'),]
 
> # compute the GDP per country per day 
> # 365 days; computed where possible
> alldata_1970$pop <- as.numeric(alldata_1970$population)
> alldata_1970$GDP_pp_day <- (alldata_1970$gdp / alldata_1970$pop) / 365

> # introduce the 5 categories

> # first subset OPEC, OECD, others
> OPEC <- alldata_1970[ which(alldata_1970$OPEC=='1'),]
> OECD <- alldata_1970[ which(alldata_1970$OECD=='1'),]
> # now set indicator NAs to 0 to select out the OTHERS file
> library(dplyr)
> alldata_1970 <- alldata_1970 %>% mutate(OPEC = ifelse(is.na(OPEC),0,OPEC))
> alldata_1970 <- alldata_1970 %>% mutate(OECD = ifelse(is.na(OECD),0,OECD))
> OTHERS <- alldata_1970[ which(alldata_1970$OPEC=='0' &  
  alldata_1970$OECD=='0'),]


> # full data with OECD/OPEC/continents otherwise 
> OPEC$category <- "OPEC"
> OECD$category <- "OECD"
> OTHERS$category <- OTHERS$continent
> re_pack_1970=rbind(OPEC,OECD,OTHERS)

> # remove where GDP_pp_day cannot be determined from missing data
> # remove Oceania
> # remove cases of nonpositive ('NA') values of population for the weighting

> re_pack_1970_2 <-  re_pack_1970[ which(re_pack_1970$pop > 0 & re_pack_1970$GDP_pp_day > 0 & re_pack_1970$category != 'Oceania'),]

> library(ggplot2)


> # make a weighted plot

> ggplot(re_pack_1970_2, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()

> # note: also did this without the population weighting
> # in that case there was visible data at a higher end of the density
> # but it disappears with the weighting due to the smaller population sizes
> # of countries with higher GDP per person per day in 1970


```

## Problem 5.2

Now do the same but show each of the five groups separately.

```{r,warning=FALSE}
# Your code goes here.

> # break into the 5 specified groups

> OECD_1970 <-  re_pack_1970_2[ which(re_pack_1970_2$category == 'OECD'),]
> OPEC_1970 <-  re_pack_1970_2[ which(re_pack_1970_2$category == 'OPEC'),]
> AFRICA_1970 <-  re_pack_1970_2[ which(re_pack_1970_2$category == 'Africa'),]
> ASIA_1970 <-  re_pack_1970_2[ which(re_pack_1970_2$category == 'Asia'),]
> AMERICA_1970 <-  re_pack_1970_2[ which(re_pack_1970_2$category == 'Americas'),]


> # make the group plots

> ggplot(OECD_1970, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(OPEC_1970, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(AFRICA_1970, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(ASIA_1970, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(AMERICA_1970, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()

> # Looking at these 1970 densities, in the OPEC and OECD groups, it looks
> # like the more populous nations are also the highest in GDP/person/day.
> # there is a bimodal shape for Africa, with some high-GDP area relative
> # to the rest (South Africa). Both Asia and the Americas in 1970 had
> # most of their populations in countries with low GDP/person/day.

> # for this exercise I will look at these densities for the years
> # 1990 and 2010 as well.
> 
> # The code can be repeated as above (not copied here) except that the year
> # can be changed to obtain the relevant dataset.

 


> # To visualize trends more directly, I am going to stack the 1970, 1990 and
> # 2010 data points into a single dataset and consider "year" as an 
> # additional category

> # to compare the visuals, I will show the densities over time for the 
> # entire group (excludes Oceania) and, as a further example, the Africa 
> # and OECD regions for the years 1970, 1990 and 2010. 

> # Although the densities will not each = 1, I will also show an overlay
> # graph containing the densities over the 3 years observed both overall and
> # in Africa and OECD. It can be useful for spotting general trends over time.



> ggplot(re_pack_1970_2, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(re_pack_1990_2, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()
> ggplot(re_pack_1990_2, aes(x=GDP_pp_day,weight=pop/sum(pop))) + geom_density()

> # [some graphs are pasted here in the original assignment ]

> # do an overlay

> master_data <- rbind(re_pack_1970_2,re_pack_1990_2,re_pack_2010_2)
> ggplot(master_data, aes(x=GDP_pp_day,weight=pop/sum(pop),colour=year)) + geom_density()


> # [more pasted graphs]

> # Conditional on the available data for this exercise, it appears that the
> # distribution of this GDP measure has become less balanced over time,
> # showing increasing density at both the higher and (especially) lower
> # ends of the distribution. It also suggests that the high population
> # countries are more likely to show low GDP/person/day levels in 2010 than
> # in 1970.

> # For the Africa and OECD data, I will just show the overlays:

> master_Africa <-  master_data[ which(master_data$category == 'Africa'),]
> master_OECD <-  master_data[ which(master_data$category == 'OECD'),]

> # [more pasted graphs]

> # The growing dispersion of the GDP measure is evident in the above graph.

> # [more pasted graphs]

> # In the OECD, there is less "inequality" in all years observed than we see
> # in both the general and Africa cases. However, there is again a shifting 
> # over time as well, but in a different way: a redistribution away from the 
> # lower ranges toward the higher levels. Some OECD countries are 
> # doing very well in 2010, and fewer are doing poorly. 





```


## Problem 5.3

Visualize these densities for several years. Show a couple of of them. Summarize how the distribution has changed through the years.

```{r,warning=FALSE}
# Put your code here.
```
